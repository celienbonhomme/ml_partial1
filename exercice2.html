
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Exercice 2 &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'exercice2';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Exercice 3" href="exercice3.html" />
    <link rel="prev" title="Exercice 1" href="exercice1.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Partial
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="exercice1.html">Exercice 1</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Exercice 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="exercice3.html">Exercice 3</a></li>
<li class="toctree-l1"><a class="reference internal" href="exercice4.html">Exercice 4</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fexercice2.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/exercice2.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Exercice 2</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wind-speed">Wind speed</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-data">Load data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#eda">EDA</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fraud-detection">Fraud detection</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Load data</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="exercice-2">
<h1>Exercice 2<a class="headerlink" href="#exercice-2" title="Link to this heading">#</a></h1>
<section id="wind-speed">
<h2>Wind speed<a class="headerlink" href="#wind-speed" title="Link to this heading">#</a></h2>
<section id="load-data">
<h3>Load data<a class="headerlink" href="#load-data" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">df_wind</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/lihkir/Data/main/wind_speed/data_treino_dv_df_2000_2010.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_101779/3608521925.py:1: DeprecationWarning: 
Pyarrow will become a required dependency of pandas in the next major release of pandas (pandas 3.0),
(to allow more performant data types, such as the Arrow string type, and better interoperability with other libraries)
but was not found to be installed on your system.
If this would cause problems for you,
please provide us feedback at https://github.com/pandas-dev/pandas/issues/54466
        
  import pandas as pd
</pre></div>
</div>
</div>
</div>
</section>
<section id="eda">
<h3>EDA<a class="headerlink" href="#eda" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_wind</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>HORA (UTC)</th>
      <th>VENTO, DIREï¿½ï¿½O HORARIA (gr) (ï¿½ (gr))</th>
      <th>VENTO, VELOCIDADE HORARIA (m/s)</th>
      <th>UMIDADE REL. MAX. NA HORA ANT. (AUT) (%)</th>
      <th>UMIDADE REL. MIN. NA HORA ANT. (AUT) (%)</th>
      <th>TEMPERATURA Mï¿½XIMA NA HORA ANT. (AUT) (ï¿½C)</th>
      <th>TEMPERATURA Mï¿½NIMA NA HORA ANT. (AUT) (ï¿½C)</th>
      <th>UMIDADE RELATIVA DO AR, HORARIA (%)</th>
      <th>PRESSAO ATMOSFERICA AO NIVEL DA ESTACAO, HORARIA (mB)</th>
      <th>PRECIPITAï¿½ï¿½O TOTAL, HORï¿½RIO (mm)</th>
      <th>VENTO, RAJADA MAXIMA (m/s)</th>
      <th>PRESSï¿½O ATMOSFERICA MAX.NA HORA ANT. (AUT) (mB)</th>
      <th>PRESSï¿½O ATMOSFERICA MIN. NA HORA ANT. (AUT) (mB)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12:00</td>
      <td>0.809017</td>
      <td>1.8</td>
      <td>69.0</td>
      <td>60.0</td>
      <td>22.6</td>
      <td>20.7</td>
      <td>61.0</td>
      <td>888.2</td>
      <td>0.0</td>
      <td>3.8</td>
      <td>888.2</td>
      <td>887.7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13:00</td>
      <td>0.965926</td>
      <td>2.7</td>
      <td>62.0</td>
      <td>55.0</td>
      <td>24.2</td>
      <td>22.5</td>
      <td>55.0</td>
      <td>888.4</td>
      <td>0.0</td>
      <td>4.7</td>
      <td>888.4</td>
      <td>888.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>14:00</td>
      <td>0.891007</td>
      <td>2.0</td>
      <td>56.0</td>
      <td>50.0</td>
      <td>25.5</td>
      <td>24.3</td>
      <td>51.0</td>
      <td>888.1</td>
      <td>0.0</td>
      <td>4.9</td>
      <td>888.4</td>
      <td>888.1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15:00</td>
      <td>0.848048</td>
      <td>2.5</td>
      <td>52.0</td>
      <td>44.0</td>
      <td>27.4</td>
      <td>25.0</td>
      <td>44.0</td>
      <td>887.4</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>888.1</td>
      <td>887.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>16:00</td>
      <td>0.224951</td>
      <td>2.4</td>
      <td>50.0</td>
      <td>43.0</td>
      <td>27.1</td>
      <td>25.5</td>
      <td>46.0</td>
      <td>886.5</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>887.4</td>
      <td>886.5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>17:00</td>
      <td>0.034899</td>
      <td>1.8</td>
      <td>48.0</td>
      <td>41.0</td>
      <td>27.4</td>
      <td>25.9</td>
      <td>45.0</td>
      <td>885.9</td>
      <td>0.0</td>
      <td>4.3</td>
      <td>886.5</td>
      <td>885.9</td>
    </tr>
    <tr>
      <th>6</th>
      <td>18:00</td>
      <td>0.819152</td>
      <td>1.8</td>
      <td>46.0</td>
      <td>36.0</td>
      <td>28.3</td>
      <td>26.8</td>
      <td>38.0</td>
      <td>885.5</td>
      <td>0.0</td>
      <td>6.3</td>
      <td>885.9</td>
      <td>885.5</td>
    </tr>
    <tr>
      <th>7</th>
      <td>19:00</td>
      <td>0.798636</td>
      <td>1.1</td>
      <td>43.0</td>
      <td>37.0</td>
      <td>28.1</td>
      <td>26.6</td>
      <td>41.0</td>
      <td>885.6</td>
      <td>0.0</td>
      <td>3.8</td>
      <td>885.6</td>
      <td>885.4</td>
    </tr>
    <tr>
      <th>8</th>
      <td>20:00</td>
      <td>0.945519</td>
      <td>1.5</td>
      <td>45.0</td>
      <td>38.0</td>
      <td>27.4</td>
      <td>25.8</td>
      <td>44.0</td>
      <td>885.9</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>885.9</td>
      <td>885.5</td>
    </tr>
    <tr>
      <th>9</th>
      <td>21:00</td>
      <td>-0.292372</td>
      <td>1.3</td>
      <td>59.0</td>
      <td>45.0</td>
      <td>25.8</td>
      <td>23.6</td>
      <td>51.0</td>
      <td>886.2</td>
      <td>0.0</td>
      <td>3.2</td>
      <td>886.2</td>
      <td>885.8</td>
    </tr>
    <tr>
      <th>10</th>
      <td>22:00</td>
      <td>0.069756</td>
      <td>1.3</td>
      <td>53.0</td>
      <td>50.0</td>
      <td>24.1</td>
      <td>23.2</td>
      <td>51.0</td>
      <td>886.5</td>
      <td>0.0</td>
      <td>2.6</td>
      <td>886.5</td>
      <td>886.2</td>
    </tr>
    <tr>
      <th>11</th>
      <td>23:00</td>
      <td>0.207912</td>
      <td>1.0</td>
      <td>54.0</td>
      <td>50.0</td>
      <td>23.3</td>
      <td>22.5</td>
      <td>54.0</td>
      <td>886.9</td>
      <td>0.0</td>
      <td>3.1</td>
      <td>886.9</td>
      <td>886.5</td>
    </tr>
    <tr>
      <th>12</th>
      <td>00:00</td>
      <td>0.809017</td>
      <td>0.3</td>
      <td>58.0</td>
      <td>53.0</td>
      <td>22.5</td>
      <td>21.3</td>
      <td>58.0</td>
      <td>887.4</td>
      <td>0.0</td>
      <td>1.6</td>
      <td>887.4</td>
      <td>886.9</td>
    </tr>
    <tr>
      <th>13</th>
      <td>01:00</td>
      <td>0.891007</td>
      <td>1.5</td>
      <td>61.0</td>
      <td>57.0</td>
      <td>21.6</td>
      <td>21.1</td>
      <td>61.0</td>
      <td>888.0</td>
      <td>0.0</td>
      <td>3.2</td>
      <td>888.0</td>
      <td>887.4</td>
    </tr>
    <tr>
      <th>14</th>
      <td>02:00</td>
      <td>-0.069756</td>
      <td>1.5</td>
      <td>68.0</td>
      <td>60.0</td>
      <td>21.0</td>
      <td>19.1</td>
      <td>64.0</td>
      <td>888.1</td>
      <td>0.0</td>
      <td>2.5</td>
      <td>888.1</td>
      <td>887.9</td>
    </tr>
    <tr>
      <th>15</th>
      <td>03:00</td>
      <td>0.207912</td>
      <td>1.0</td>
      <td>69.0</td>
      <td>64.0</td>
      <td>19.8</td>
      <td>18.7</td>
      <td>67.0</td>
      <td>888.3</td>
      <td>0.0</td>
      <td>2.7</td>
      <td>888.4</td>
      <td>888.1</td>
    </tr>
    <tr>
      <th>16</th>
      <td>04:00</td>
      <td>-0.052336</td>
      <td>1.4</td>
      <td>69.0</td>
      <td>65.0</td>
      <td>19.4</td>
      <td>18.6</td>
      <td>68.0</td>
      <td>888.0</td>
      <td>0.0</td>
      <td>2.7</td>
      <td>888.3</td>
      <td>888.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>05:00</td>
      <td>0.173648</td>
      <td>0.9</td>
      <td>73.0</td>
      <td>68.0</td>
      <td>18.9</td>
      <td>18.2</td>
      <td>73.0</td>
      <td>887.4</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>888.0</td>
      <td>887.4</td>
    </tr>
    <tr>
      <th>18</th>
      <td>06:00</td>
      <td>0.241922</td>
      <td>1.5</td>
      <td>74.0</td>
      <td>72.0</td>
      <td>18.5</td>
      <td>18.1</td>
      <td>74.0</td>
      <td>887.3</td>
      <td>0.0</td>
      <td>2.5</td>
      <td>887.4</td>
      <td>887.2</td>
    </tr>
    <tr>
      <th>19</th>
      <td>07:00</td>
      <td>0.453990</td>
      <td>1.5</td>
      <td>80.0</td>
      <td>74.0</td>
      <td>18.5</td>
      <td>17.6</td>
      <td>80.0</td>
      <td>887.5</td>
      <td>0.0</td>
      <td>3.3</td>
      <td>887.5</td>
      <td>887.3</td>
    </tr>
    <tr>
      <th>20</th>
      <td>08:00</td>
      <td>0.669131</td>
      <td>1.9</td>
      <td>86.0</td>
      <td>80.0</td>
      <td>17.8</td>
      <td>16.5</td>
      <td>84.0</td>
      <td>887.6</td>
      <td>0.0</td>
      <td>2.7</td>
      <td>887.7</td>
      <td>887.5</td>
    </tr>
    <tr>
      <th>21</th>
      <td>09:00</td>
      <td>0.707107</td>
      <td>1.8</td>
      <td>85.0</td>
      <td>84.0</td>
      <td>17.4</td>
      <td>17.2</td>
      <td>85.0</td>
      <td>888.0</td>
      <td>0.0</td>
      <td>3.6</td>
      <td>888.0</td>
      <td>887.6</td>
    </tr>
    <tr>
      <th>22</th>
      <td>10:00</td>
      <td>0.694658</td>
      <td>1.5</td>
      <td>85.0</td>
      <td>82.0</td>
      <td>18.1</td>
      <td>17.1</td>
      <td>82.0</td>
      <td>888.9</td>
      <td>0.0</td>
      <td>2.6</td>
      <td>888.9</td>
      <td>888.0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>11:00</td>
      <td>0.629320</td>
      <td>2.5</td>
      <td>82.0</td>
      <td>77.0</td>
      <td>20.0</td>
      <td>18.1</td>
      <td>77.0</td>
      <td>889.4</td>
      <td>0.0</td>
      <td>3.7</td>
      <td>889.4</td>
      <td>888.9</td>
    </tr>
    <tr>
      <th>24</th>
      <td>12:00</td>
      <td>0.906308</td>
      <td>4.0</td>
      <td>78.0</td>
      <td>71.0</td>
      <td>21.9</td>
      <td>20.0</td>
      <td>71.0</td>
      <td>889.9</td>
      <td>0.0</td>
      <td>5.3</td>
      <td>889.9</td>
      <td>889.4</td>
    </tr>
    <tr>
      <th>25</th>
      <td>13:00</td>
      <td>0.866025</td>
      <td>4.0</td>
      <td>72.0</td>
      <td>63.0</td>
      <td>23.7</td>
      <td>22.0</td>
      <td>63.0</td>
      <td>890.1</td>
      <td>0.0</td>
      <td>6.5</td>
      <td>890.2</td>
      <td>889.9</td>
    </tr>
    <tr>
      <th>26</th>
      <td>14:00</td>
      <td>0.965926</td>
      <td>3.7</td>
      <td>65.0</td>
      <td>51.0</td>
      <td>25.6</td>
      <td>23.5</td>
      <td>53.0</td>
      <td>889.8</td>
      <td>0.0</td>
      <td>6.4</td>
      <td>890.1</td>
      <td>889.8</td>
    </tr>
    <tr>
      <th>27</th>
      <td>15:00</td>
      <td>0.838671</td>
      <td>3.3</td>
      <td>57.0</td>
      <td>47.0</td>
      <td>26.3</td>
      <td>24.9</td>
      <td>47.0</td>
      <td>889.1</td>
      <td>0.0</td>
      <td>6.8</td>
      <td>889.7</td>
      <td>889.1</td>
    </tr>
    <tr>
      <th>28</th>
      <td>16:00</td>
      <td>0.999391</td>
      <td>2.6</td>
      <td>48.0</td>
      <td>34.0</td>
      <td>27.1</td>
      <td>26.0</td>
      <td>38.0</td>
      <td>888.5</td>
      <td>0.0</td>
      <td>7.1</td>
      <td>889.1</td>
      <td>888.5</td>
    </tr>
    <tr>
      <th>29</th>
      <td>17:00</td>
      <td>0.777146</td>
      <td>2.3</td>
      <td>43.0</td>
      <td>33.0</td>
      <td>28.0</td>
      <td>26.4</td>
      <td>35.0</td>
      <td>887.7</td>
      <td>0.0</td>
      <td>5.3</td>
      <td>888.5</td>
      <td>887.7</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_wind</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 87693 entries, 0 to 87692
Data columns (total 13 columns):
 #   Column                                                 Non-Null Count  Dtype  
---  ------                                                 --------------  -----  
 0   HORA (UTC)                                             87693 non-null  object 
 1   VENTO, DIREï¿½ï¿½O HORARIA (gr) (ï¿½ (gr))             87693 non-null  float64
 2   VENTO, VELOCIDADE HORARIA (m/s)                        87693 non-null  float64
 3   UMIDADE REL. MAX. NA HORA ANT. (AUT) (%)               87693 non-null  float64
 4   UMIDADE REL. MIN. NA HORA ANT. (AUT) (%)               87693 non-null  float64
 5   TEMPERATURA Mï¿½XIMA NA HORA ANT. (AUT) (ï¿½C)         87693 non-null  float64
 6   TEMPERATURA Mï¿½NIMA NA HORA ANT. (AUT) (ï¿½C)         87693 non-null  float64
 7   UMIDADE RELATIVA DO AR, HORARIA (%)                    87693 non-null  float64
 8   PRESSAO ATMOSFERICA AO NIVEL DA ESTACAO, HORARIA (mB)  87693 non-null  float64
 9   PRECIPITAï¿½ï¿½O TOTAL, HORï¿½RIO (mm)                 87693 non-null  float64
 10  VENTO, RAJADA MAXIMA (m/s)                             87693 non-null  float64
 11  PRESSï¿½O ATMOSFERICA MAX.NA HORA ANT. (AUT) (mB)      87693 non-null  float64
 12  PRESSï¿½O ATMOSFERICA MIN. NA HORA ANT. (AUT) (mB)     87693 non-null  float64
dtypes: float64(12), object(1)
memory usage: 8.7+ MB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_wind</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;HORA (UTC)&#39;, &#39;VENTO, DIREï¿½ï¿½O HORARIA (gr) (ï¿½ (gr))&#39;,
       &#39;VENTO, VELOCIDADE HORARIA (m/s)&#39;,
       &#39;UMIDADE REL. MAX. NA HORA ANT. (AUT) (%)&#39;,
       &#39;UMIDADE REL. MIN. NA HORA ANT. (AUT) (%)&#39;,
       &#39;TEMPERATURA Mï¿½XIMA NA HORA ANT. (AUT) (ï¿½C)&#39;,
       &#39;TEMPERATURA Mï¿½NIMA NA HORA ANT. (AUT) (ï¿½C)&#39;,
       &#39;UMIDADE RELATIVA DO AR, HORARIA (%)&#39;,
       &#39;PRESSAO ATMOSFERICA AO NIVEL DA ESTACAO, HORARIA (mB)&#39;,
       &#39;PRECIPITAï¿½ï¿½O TOTAL, HORï¿½RIO (mm)&#39;, &#39;VENTO, RAJADA MAXIMA (m/s)&#39;,
       &#39;PRESSï¿½O ATMOSFERICA MAX.NA HORA ANT. (AUT) (mB)&#39;,
       &#39;PRESSï¿½O ATMOSFERICA MIN. NA HORA ANT. (AUT) (mB)&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>Let’s rename the names of the columns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_columns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;Time&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Wind_direction&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Wind_speed&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Relative_humidity_max&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Relative_humidity_min&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Temperature_max&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Temperature_min&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Relative_humidity_avg&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Pressure&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Precipitation_total&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Wind_speed_max&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Pressure_max&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Pressure_min&#39;</span>
<span class="p">]</span>
<span class="n">df_wind</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">df_wind</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">new_columns</span><span class="p">)),</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_wind</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Time</th>
      <th>Wind_direction</th>
      <th>Wind_speed</th>
      <th>Relative_humidity_max</th>
      <th>Relative_humidity_min</th>
      <th>Temperature_max</th>
      <th>Temperature_min</th>
      <th>Relative_humidity_avg</th>
      <th>Pressure</th>
      <th>Precipitation_total</th>
      <th>Wind_speed_max</th>
      <th>Pressure_max</th>
      <th>Pressure_min</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12:00</td>
      <td>0.809017</td>
      <td>1.8</td>
      <td>69.0</td>
      <td>60.0</td>
      <td>22.6</td>
      <td>20.7</td>
      <td>61.0</td>
      <td>888.2</td>
      <td>0.0</td>
      <td>3.8</td>
      <td>888.2</td>
      <td>887.7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13:00</td>
      <td>0.965926</td>
      <td>2.7</td>
      <td>62.0</td>
      <td>55.0</td>
      <td>24.2</td>
      <td>22.5</td>
      <td>55.0</td>
      <td>888.4</td>
      <td>0.0</td>
      <td>4.7</td>
      <td>888.4</td>
      <td>888.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>14:00</td>
      <td>0.891007</td>
      <td>2.0</td>
      <td>56.0</td>
      <td>50.0</td>
      <td>25.5</td>
      <td>24.3</td>
      <td>51.0</td>
      <td>888.1</td>
      <td>0.0</td>
      <td>4.9</td>
      <td>888.4</td>
      <td>888.1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15:00</td>
      <td>0.848048</td>
      <td>2.5</td>
      <td>52.0</td>
      <td>44.0</td>
      <td>27.4</td>
      <td>25.0</td>
      <td>44.0</td>
      <td>887.4</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>888.1</td>
      <td>887.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>16:00</td>
      <td>0.224951</td>
      <td>2.4</td>
      <td>50.0</td>
      <td>43.0</td>
      <td>27.1</td>
      <td>25.5</td>
      <td>46.0</td>
      <td>886.5</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>887.4</td>
      <td>886.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_wind</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(87693, 13)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_wind</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Wind_direction</th>
      <th>Wind_speed</th>
      <th>Relative_humidity_max</th>
      <th>Relative_humidity_min</th>
      <th>Temperature_max</th>
      <th>Temperature_min</th>
      <th>Relative_humidity_avg</th>
      <th>Pressure</th>
      <th>Precipitation_total</th>
      <th>Wind_speed_max</th>
      <th>Pressure_max</th>
      <th>Pressure_min</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.405810</td>
      <td>2.466192</td>
      <td>69.058465</td>
      <td>63.176194</td>
      <td>21.921264</td>
      <td>20.684570</td>
      <td>66.146682</td>
      <td>887.251925</td>
      <td>0.160907</td>
      <td>5.161076</td>
      <td>887.580724</td>
      <td>886.891093</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.686247</td>
      <td>1.313968</td>
      <td>19.640222</td>
      <td>20.166336</td>
      <td>3.721386</td>
      <td>3.513744</td>
      <td>19.992327</td>
      <td>4.012404</td>
      <td>1.307515</td>
      <td>2.311157</td>
      <td>3.646750</td>
      <td>3.564539</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-1.000000</td>
      <td>0.000000</td>
      <td>12.000000</td>
      <td>10.000000</td>
      <td>9.200000</td>
      <td>8.400000</td>
      <td>10.000000</td>
      <td>863.400000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>865.300000</td>
      <td>862.800000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-0.156434</td>
      <td>1.500000</td>
      <td>54.000000</td>
      <td>48.000000</td>
      <td>19.200000</td>
      <td>18.400000</td>
      <td>51.000000</td>
      <td>885.300000</td>
      <td>0.000000</td>
      <td>3.400000</td>
      <td>885.600000</td>
      <td>885.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.788011</td>
      <td>2.400000</td>
      <td>72.000000</td>
      <td>64.000000</td>
      <td>21.400000</td>
      <td>20.200000</td>
      <td>68.000000</td>
      <td>887.200000</td>
      <td>0.000000</td>
      <td>5.000000</td>
      <td>887.500000</td>
      <td>886.900000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.970296</td>
      <td>3.400000</td>
      <td>87.000000</td>
      <td>80.000000</td>
      <td>24.700000</td>
      <td>23.100000</td>
      <td>84.000000</td>
      <td>889.100000</td>
      <td>0.000000</td>
      <td>6.800000</td>
      <td>889.300000</td>
      <td>888.800000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.000000</td>
      <td>10.000000</td>
      <td>100.000000</td>
      <td>98.000000</td>
      <td>35.300000</td>
      <td>34.400000</td>
      <td>99.000000</td>
      <td>1023.500000</td>
      <td>70.800000</td>
      <td>24.300000</td>
      <td>913.100000</td>
      <td>910.900000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Let’s count the number of Nan values</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing_data_count</span> <span class="o">=</span> <span class="n">df_wind</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">missing_data_percentage</span> <span class="o">=</span> <span class="p">(</span><span class="n">missing_data_count</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_wind</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>

<span class="n">missing_data_stats</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Missing data&#39;</span><span class="p">:</span> <span class="n">missing_data_count</span><span class="p">,</span>
    <span class="s1">&#39;Percentage of missing data&#39;</span><span class="p">:</span> <span class="n">missing_data_percentage</span>
<span class="p">})</span>

<span class="n">missing_data_stats</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Missing data</th>
      <th>Percentage of missing data</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Time</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Wind_direction</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Wind_speed</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Relative_humidity_max</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Relative_humidity_min</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Temperature_max</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Temperature_min</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Relative_humidity_avg</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Pressure</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Precipitation_total</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Wind_speed_max</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Pressure_max</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Pressure_min</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We can see that every value is attributed</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="k">def</span> <span class="nf">str2hour</span><span class="p">(</span><span class="n">string_hour</span><span class="p">):</span>
    <span class="n">datetime_obj</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">string_hour</span><span class="p">,</span> <span class="s1">&#39;%H:%M&#39;</span><span class="p">)</span>
    <span class="n">numeric_hour</span> <span class="o">=</span> <span class="n">datetime_obj</span><span class="o">.</span><span class="n">hour</span>
    <span class="k">return</span> <span class="n">numeric_hour</span>

<span class="n">df_wind</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_wind</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">str2hour</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_wind</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Time</th>
      <th>Wind_direction</th>
      <th>Wind_speed</th>
      <th>Relative_humidity_max</th>
      <th>Relative_humidity_min</th>
      <th>Temperature_max</th>
      <th>Temperature_min</th>
      <th>Relative_humidity_avg</th>
      <th>Pressure</th>
      <th>Precipitation_total</th>
      <th>Wind_speed_max</th>
      <th>Pressure_max</th>
      <th>Pressure_min</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12</td>
      <td>0.809017</td>
      <td>1.8</td>
      <td>69.0</td>
      <td>60.0</td>
      <td>22.6</td>
      <td>20.7</td>
      <td>61.0</td>
      <td>888.2</td>
      <td>0.0</td>
      <td>3.8</td>
      <td>888.2</td>
      <td>887.7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13</td>
      <td>0.965926</td>
      <td>2.7</td>
      <td>62.0</td>
      <td>55.0</td>
      <td>24.2</td>
      <td>22.5</td>
      <td>55.0</td>
      <td>888.4</td>
      <td>0.0</td>
      <td>4.7</td>
      <td>888.4</td>
      <td>888.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>14</td>
      <td>0.891007</td>
      <td>2.0</td>
      <td>56.0</td>
      <td>50.0</td>
      <td>25.5</td>
      <td>24.3</td>
      <td>51.0</td>
      <td>888.1</td>
      <td>0.0</td>
      <td>4.9</td>
      <td>888.4</td>
      <td>888.1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15</td>
      <td>0.848048</td>
      <td>2.5</td>
      <td>52.0</td>
      <td>44.0</td>
      <td>27.4</td>
      <td>25.0</td>
      <td>44.0</td>
      <td>887.4</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>888.1</td>
      <td>887.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>16</td>
      <td>0.224951</td>
      <td>2.4</td>
      <td>50.0</td>
      <td>43.0</td>
      <td>27.1</td>
      <td>25.5</td>
      <td>46.0</td>
      <td>886.5</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>887.4</td>
      <td>886.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Let’s see the correlation matrix so see the correlation between the columns</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">correlation_matrix</span> <span class="o">=</span> <span class="n">df_wind</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">abs</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">correlation_matrix</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;.2f&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Variables&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Variables&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Correlation matrix&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/990a0555a95169e5e3eb643b8bce5706a70c5bc5b62e15445817cfadb81ed850.png" src="_images/990a0555a95169e5e3eb643b8bce5706a70c5bc5b62e15445817cfadb81ed850.png" />
</div>
</div>
<p>We can see that some columns are very dependant on the other like Pressure_min and Pressure_max for instance</p>
<p>Let’s study some columns :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="n">independent_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Wind_direction&#39;</span><span class="p">,</span> <span class="s1">&#39;Wind_speed&#39;</span><span class="p">,</span> <span class="s1">&#39;Temperature_max&#39;</span><span class="p">,</span> <span class="s1">&#39;Relative_humidity_avg&#39;</span><span class="p">,</span> <span class="s1">&#39;Pressure&#39;</span><span class="p">,</span> <span class="s1">&#39;Precipitation_total&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">independent_vars</span><span class="p">):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_wind</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">var</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Histogram of </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/384fefb13f661a5888b7cfb9662e930898c390f721ee229627e03dd9d0b50064.png" src="_images/384fefb13f661a5888b7cfb9662e930898c390f721ee229627e03dd9d0b50064.png" />
</div>
</div>
<p>We have very different type of repartition.</p>
<p>Let’s see the boxplot</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="n">independent_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Wind_direction&#39;</span><span class="p">,</span> <span class="s1">&#39;Wind_speed&#39;</span><span class="p">,</span> <span class="s1">&#39;Temperature_max&#39;</span><span class="p">,</span> <span class="s1">&#39;Relative_humidity_avg&#39;</span><span class="p">,</span> <span class="s1">&#39;Pressure&#39;</span><span class="p">,</span> <span class="s1">&#39;Precipitation_total&#39;</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">independent_vars</span><span class="p">):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df_wind</span><span class="p">[</span><span class="n">var</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Boxplot of </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e96e0158cc1fb1729a32832d74ca69cb5665ae3b3113e75ce4b1e9cb4a2454a5.png" src="_images/e96e0158cc1fb1729a32832d74ca69cb5665ae3b3113e75ce4b1e9cb4a2454a5.png" />
</div>
</div>
<p>As we could see before with the histograms, precipitation total is mainly concentrated on 0, we can study the values &gt; 5mm to see if it changes something.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>


<span class="n">df_precipitation_relevant</span> <span class="o">=</span> <span class="n">df_wind</span><span class="p">[</span><span class="n">df_wind</span><span class="p">[</span><span class="s1">&#39;Precipitation_total&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># Boxplot</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df_precipitation_relevant</span><span class="p">[</span><span class="s1">&#39;Precipitation_total&#39;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Precipitation_total&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Boxplot of Precipitation_total (&gt; 5 mm)&#39;</span><span class="p">)</span>

<span class="c1"># Histplot</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_precipitation_relevant</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Precipitation_total&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Precipitation_total&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Histogram of Precipitation_total (&gt; 5 mm)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d6716d44138ef6b0986575871601cc0818e9b081a1855bd133cc4bd21ae6aaa8.png" src="_images/d6716d44138ef6b0986575871601cc0818e9b081a1855bd133cc4bd21ae6aaa8.png" />
</div>
</div>
<p>We still have a concentration near from 0.</p>
<p>Let’s observe the correlation betwenn the variables thanks to pairplot</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_wind</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.PairGrid at 0x7f5e70126ca0&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Error in callback &lt;function flush_figures at 0x7f5e7bb0d040&gt; (for post_execute), with arguments args (),kwargs {}:
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="nn">File ~/miniconda3/envs/ml_venv/lib/python3.9/site-packages/matplotlib_inline/backend_inline.py:126,</span> in <span class="ni">flush_figures</span><span class="nt">()</span>
<span class="g g-Whitespace">    </span><span class="mi">123</span> <span class="k">if</span> <span class="n">InlineBackend</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span><span class="o">.</span><span class="n">close_figures</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">124</span>     <span class="c1"># ignore the tracking, just draw and close all figures</span>
<span class="g g-Whitespace">    </span><span class="mi">125</span>     <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">126</span>         <span class="k">return</span> <span class="n">show</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">127</span>     <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">128</span>         <span class="c1"># safely show traceback if in IPython, else raise</span>
<span class="g g-Whitespace">    </span><span class="mi">129</span>         <span class="n">ip</span> <span class="o">=</span> <span class="n">get_ipython</span><span class="p">()</span>

<span class="nn">File ~/miniconda3/envs/ml_venv/lib/python3.9/site-packages/matplotlib_inline/backend_inline.py:90,</span> in <span class="ni">show</span><span class="nt">(close, block)</span>
<span class="g g-Whitespace">     </span><span class="mi">88</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">89</span>     <span class="k">for</span> <span class="n">figure_manager</span> <span class="ow">in</span> <span class="n">Gcf</span><span class="o">.</span><span class="n">get_all_fig_managers</span><span class="p">():</span>
<span class="ne">---&gt; </span><span class="mi">90</span>         <span class="n">display</span><span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">91</span>             <span class="n">figure_manager</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">figure</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">92</span>             <span class="n">metadata</span><span class="o">=</span><span class="n">_fetch_figure_metadata</span><span class="p">(</span><span class="n">figure_manager</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">figure</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">93</span>         <span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">94</span> <span class="k">finally</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">95</span>     <span class="n">show</span><span class="o">.</span><span class="n">_to_draw</span> <span class="o">=</span> <span class="p">[]</span>

<span class="nn">File ~/miniconda3/envs/ml_venv/lib/python3.9/site-packages/IPython/core/display_functions.py:298,</span> in <span class="ni">display</span><span class="nt">(include, exclude, metadata, transient, display_id, raw, clear, *objs, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">296</span>     <span class="n">publish_display_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">297</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">298</span>     <span class="n">format_dict</span><span class="p">,</span> <span class="n">md_dict</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">include</span><span class="o">=</span><span class="n">include</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">299</span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">format_dict</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">300</span>         <span class="c1"># nothing to display (e.g. _ipython_display_ took over)</span>
<span class="g g-Whitespace">    </span><span class="mi">301</span>         <span class="k">continue</span>

<span class="nn">File ~/miniconda3/envs/ml_venv/lib/python3.9/site-packages/IPython/core/formatters.py:179,</span> in <span class="ni">DisplayFormatter.format</span><span class="nt">(self, obj, include, exclude)</span>
<span class="g g-Whitespace">    </span><span class="mi">177</span> <span class="n">md</span> <span class="o">=</span> <span class="kc">None</span>
<span class="g g-Whitespace">    </span><span class="mi">178</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">179</span>     <span class="n">data</span> <span class="o">=</span> <span class="n">formatter</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">180</span> <span class="k">except</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">181</span>     <span class="c1"># FIXME: log the exception</span>
<span class="g g-Whitespace">    </span><span class="mi">182</span>     <span class="k">raise</span>

<span class="nn">File ~/miniconda3/envs/ml_venv/lib/python3.9/site-packages/decorator.py:232,</span> in <span class="ni">decorate.&lt;locals&gt;.fun</span><span class="nt">(*args, **kw)</span>
<span class="g g-Whitespace">    </span><span class="mi">230</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">kwsyntax</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">231</span>     <span class="n">args</span><span class="p">,</span> <span class="n">kw</span> <span class="o">=</span> <span class="n">fix</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">kw</span><span class="p">,</span> <span class="n">sig</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">232</span> <span class="k">return</span> <span class="n">caller</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="n">extras</span> <span class="o">+</span> <span class="n">args</span><span class="p">),</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/ml_venv/lib/python3.9/site-packages/IPython/core/formatters.py:223,</span> in <span class="ni">catch_format_error</span><span class="nt">(method, self, *args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">221</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;show traceback on failed format call&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">222</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">223</span>     <span class="n">r</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">224</span> <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">225</span>     <span class="c1"># don&#39;t warn on NotImplementedErrors</span>
<span class="g g-Whitespace">    </span><span class="mi">226</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_return</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="nn">File ~/miniconda3/envs/ml_venv/lib/python3.9/site-packages/IPython/core/formatters.py:340,</span> in <span class="ni">BaseFormatter.__call__</span><span class="nt">(self, obj)</span>
<span class="g g-Whitespace">    </span><span class="mi">338</span>     <span class="k">pass</span>
<span class="g g-Whitespace">    </span><span class="mi">339</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">340</span>     <span class="k">return</span> <span class="n">printer</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">341</span> <span class="c1"># Finally look for special method names</span>
<span class="g g-Whitespace">    </span><span class="mi">342</span> <span class="n">method</span> <span class="o">=</span> <span class="n">get_real_method</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_method</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/ml_venv/lib/python3.9/site-packages/IPython/core/pylabtools.py:152,</span> in <span class="ni">print_figure</span><span class="nt">(fig, fmt, bbox_inches, base64, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">149</span>     <span class="kn">from</span> <span class="nn">matplotlib.backend_bases</span> <span class="kn">import</span> <span class="n">FigureCanvasBase</span>
<span class="g g-Whitespace">    </span><span class="mi">150</span>     <span class="n">FigureCanvasBase</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">152</span> <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">print_figure</span><span class="p">(</span><span class="n">bytes_io</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">153</span> <span class="n">data</span> <span class="o">=</span> <span class="n">bytes_io</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">154</span> <span class="k">if</span> <span class="n">fmt</span> <span class="o">==</span> <span class="s1">&#39;svg&#39;</span><span class="p">:</span>

<span class="nn">File ~/miniconda3/envs/ml_venv/lib/python3.9/site-packages/matplotlib/backend_bases.py:2164,</span> in <span class="ni">FigureCanvasBase.print_figure</span><span class="nt">(self, filename, dpi, facecolor, edgecolor, orientation, format, bbox_inches, pad_inches, bbox_extra_artists, backend, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">2161</span>     <span class="c1"># we do this instead of `self.figure.draw_without_rendering`</span>
<span class="g g-Whitespace">   </span><span class="mi">2162</span>     <span class="c1"># so that we can inject the orientation</span>
<span class="g g-Whitespace">   </span><span class="mi">2163</span>     <span class="k">with</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span> <span class="s2">&quot;_draw_disabled&quot;</span><span class="p">,</span> <span class="n">nullcontext</span><span class="p">)():</span>
<span class="ne">-&gt; </span><span class="mi">2164</span>         <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2165</span> <span class="k">if</span> <span class="n">bbox_inches</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2166</span>     <span class="k">if</span> <span class="n">bbox_inches</span> <span class="o">==</span> <span class="s2">&quot;tight&quot;</span><span class="p">:</span>

<span class="nn">File ~/miniconda3/envs/ml_venv/lib/python3.9/site-packages/matplotlib/artist.py:95,</span> in <span class="ni">_finalize_rasterization.&lt;locals&gt;.draw_wrapper</span><span class="nt">(artist, renderer, *args, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">93</span> <span class="nd">@wraps</span><span class="p">(</span><span class="n">draw</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">94</span> <span class="k">def</span> <span class="nf">draw_wrapper</span><span class="p">(</span><span class="n">artist</span><span class="p">,</span> <span class="n">renderer</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">95</span>     <span class="n">result</span> <span class="o">=</span> <span class="n">draw</span><span class="p">(</span><span class="n">artist</span><span class="p">,</span> <span class="n">renderer</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">96</span>     <span class="k">if</span> <span class="n">renderer</span><span class="o">.</span><span class="n">_rasterizing</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">97</span>         <span class="n">renderer</span><span class="o">.</span><span class="n">stop_rasterizing</span><span class="p">()</span>

<span class="nn">File ~/miniconda3/envs/ml_venv/lib/python3.9/site-packages/matplotlib/artist.py:72,</span> in <span class="ni">allow_rasterization.&lt;locals&gt;.draw_wrapper</span><span class="nt">(artist, renderer)</span>
<span class="g g-Whitespace">     </span><span class="mi">69</span>     <span class="k">if</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_agg_filter</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">70</span>         <span class="n">renderer</span><span class="o">.</span><span class="n">start_filter</span><span class="p">()</span>
<span class="ne">---&gt; </span><span class="mi">72</span>     <span class="k">return</span> <span class="n">draw</span><span class="p">(</span><span class="n">artist</span><span class="p">,</span> <span class="n">renderer</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">73</span> <span class="k">finally</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">74</span>     <span class="k">if</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_agg_filter</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">File ~/miniconda3/envs/ml_venv/lib/python3.9/site-packages/matplotlib/figure.py:3154,</span> in <span class="ni">Figure.draw</span><span class="nt">(self, renderer)</span>
<span class="g g-Whitespace">   </span><span class="mi">3151</span>         <span class="c1"># ValueError can occur when resizing a window.</span>
<span class="g g-Whitespace">   </span><span class="mi">3153</span> <span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">3154</span> <span class="n">mimage</span><span class="o">.</span><span class="n">_draw_list_compositing_images</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">3155</span>     <span class="n">renderer</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">artists</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">suppressComposite</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3157</span> <span class="k">for</span> <span class="n">sfig</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">subfigs</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">3158</span>     <span class="n">sfig</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/ml_venv/lib/python3.9/site-packages/matplotlib/image.py:132,</span> in <span class="ni">_draw_list_compositing_images</span><span class="nt">(renderer, parent, artists, suppress_composite)</span>
<span class="g g-Whitespace">    </span><span class="mi">130</span> <span class="k">if</span> <span class="n">not_composite</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">has_images</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">131</span>     <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">artists</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">132</span>         <span class="n">a</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">133</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">134</span>     <span class="c1"># Composite any adjacent images together</span>
<span class="g g-Whitespace">    </span><span class="mi">135</span>     <span class="n">image_group</span> <span class="o">=</span> <span class="p">[]</span>

<span class="nn">File ~/miniconda3/envs/ml_venv/lib/python3.9/site-packages/matplotlib/artist.py:72,</span> in <span class="ni">allow_rasterization.&lt;locals&gt;.draw_wrapper</span><span class="nt">(artist, renderer)</span>
<span class="g g-Whitespace">     </span><span class="mi">69</span>     <span class="k">if</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_agg_filter</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">70</span>         <span class="n">renderer</span><span class="o">.</span><span class="n">start_filter</span><span class="p">()</span>
<span class="ne">---&gt; </span><span class="mi">72</span>     <span class="k">return</span> <span class="n">draw</span><span class="p">(</span><span class="n">artist</span><span class="p">,</span> <span class="n">renderer</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">73</span> <span class="k">finally</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">74</span>     <span class="k">if</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_agg_filter</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">File ~/miniconda3/envs/ml_venv/lib/python3.9/site-packages/matplotlib/axes/_base.py:3034,</span> in <span class="ni">_AxesBase.draw</span><span class="nt">(self, renderer)</span>
<span class="g g-Whitespace">   </span><span class="mi">3031</span>     <span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
<span class="g g-Whitespace">   </span><span class="mi">3032</span>         <span class="n">artists</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">spine</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">3034</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_title_position</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3036</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">axison</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">3037</span>     <span class="k">for</span> <span class="n">_axis</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_axis_map</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>

<span class="nn">File ~/miniconda3/envs/ml_venv/lib/python3.9/site-packages/matplotlib/axes/_base.py:2969,</span> in <span class="ni">_AxesBase._update_title_position</span><span class="nt">(self, renderer)</span>
<span class="g g-Whitespace">   </span><span class="mi">2966</span> <span class="n">bb</span> <span class="o">=</span> <span class="kc">None</span>
<span class="g g-Whitespace">   </span><span class="mi">2967</span> <span class="k">if</span> <span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_ticks_position</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="s1">&#39;unknown&#39;</span><span class="p">]</span>
<span class="g g-Whitespace">   </span><span class="mi">2968</span>         <span class="ow">or</span> <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_label_position</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;top&#39;</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">2969</span>     <span class="n">bb</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_tightbbox</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2970</span> <span class="k">if</span> <span class="n">bb</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2971</span>     <span class="k">if</span> <span class="s1">&#39;outline&#39;</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2972</span>         <span class="c1"># Special case for colorbars:</span>

<span class="nn">File ~/miniconda3/envs/ml_venv/lib/python3.9/site-packages/matplotlib/axis.py:1336,</span> in <span class="ni">Axis.get_tightbbox</span><span class="nt">(self, renderer, for_layout_only)</span>
<span class="g g-Whitespace">   </span><span class="mi">1333</span>     <span class="n">renderer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">_get_renderer</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1334</span> <span class="n">ticks_to_draw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_ticks</span><span class="p">()</span>
<span class="ne">-&gt; </span><span class="mi">1336</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_label_position</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1338</span> <span class="c1"># go back to just this axis&#39;s tick labels</span>
<span class="g g-Whitespace">   </span><span class="mi">1339</span> <span class="n">tlb1</span><span class="p">,</span> <span class="n">tlb2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_ticklabel_bboxes</span><span class="p">(</span><span class="n">ticks_to_draw</span><span class="p">,</span> <span class="n">renderer</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/ml_venv/lib/python3.9/site-packages/matplotlib/axis.py:2374,</span> in <span class="ni">XAxis._update_label_position</span><span class="nt">(self, renderer)</span>
<span class="g g-Whitespace">   </span><span class="mi">2372</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2373</span>     <span class="n">spine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span>
<span class="ne">-&gt; </span><span class="mi">2374</span>     <span class="n">spinebbox</span> <span class="o">=</span> <span class="n">spine</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">2375</span> <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2376</span>     <span class="c1"># use Axes if spine doesn&#39;t exist</span>
<span class="g g-Whitespace">   </span><span class="mi">2377</span>     <span class="n">spinebbox</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">bbox</span>

<span class="nn">File ~/miniconda3/envs/ml_venv/lib/python3.9/site-packages/matplotlib/spines.py:158,</span> in <span class="ni">Spine.get_window_extent</span><span class="nt">(self, renderer)</span>
<span class="g g-Whitespace">    </span><span class="mi">156</span>     <span class="k">return</span> <span class="n">bb</span>
<span class="g g-Whitespace">    </span><span class="mi">157</span> <span class="n">bboxes</span> <span class="o">=</span> <span class="p">[</span><span class="n">bb</span><span class="p">]</span>
<span class="ne">--&gt; </span><span class="mi">158</span> <span class="n">drawn_ticks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">_update_ticks</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">160</span> <span class="n">major_tick</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">({</span><span class="o">*</span><span class="n">drawn_ticks</span><span class="p">}</span> <span class="o">&amp;</span> <span class="p">{</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">majorTicks</span><span class="p">}),</span> <span class="kc">None</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">161</span> <span class="n">minor_tick</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">({</span><span class="o">*</span><span class="n">drawn_ticks</span><span class="p">}</span> <span class="o">&amp;</span> <span class="p">{</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">minorTicks</span><span class="p">}),</span> <span class="kc">None</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/ml_venv/lib/python3.9/site-packages/matplotlib/axis.py:1279,</span> in <span class="ni">Axis._update_ticks</span><span class="nt">(self)</span>
<span class="g g-Whitespace">   </span><span class="mi">1277</span> <span class="n">major_ticks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_major_ticks</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">major_locs</span><span class="p">))</span>
<span class="g g-Whitespace">   </span><span class="mi">1278</span> <span class="k">for</span> <span class="n">tick</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">major_ticks</span><span class="p">,</span> <span class="n">major_locs</span><span class="p">,</span> <span class="n">major_labels</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">1279</span>     <span class="n">tick</span><span class="o">.</span><span class="n">update_position</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1280</span>     <span class="n">tick</span><span class="o">.</span><span class="n">label1</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1281</span>     <span class="n">tick</span><span class="o">.</span><span class="n">label2</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/ml_venv/lib/python3.9/site-packages/matplotlib/axis.py:449,</span> in <span class="ni">XTick.update_position</span><span class="nt">(self, loc)</span>
<span class="g g-Whitespace">    </span><span class="mi">447</span> <span class="k">def</span> <span class="nf">update_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loc</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">448</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;Set the location of tick in data coords with scalar *loc*.&quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">449</span>     <span class="bp">self</span><span class="o">.</span><span class="n">tick1line</span><span class="o">.</span><span class="n">set_xdata</span><span class="p">((</span><span class="n">loc</span><span class="p">,))</span>
<span class="g g-Whitespace">    </span><span class="mi">450</span>     <span class="bp">self</span><span class="o">.</span><span class="n">tick2line</span><span class="o">.</span><span class="n">set_xdata</span><span class="p">((</span><span class="n">loc</span><span class="p">,))</span>
<span class="g g-Whitespace">    </span><span class="mi">451</span>     <span class="bp">self</span><span class="o">.</span><span class="n">gridline</span><span class="o">.</span><span class="n">set_xdata</span><span class="p">((</span><span class="n">loc</span><span class="p">,))</span>

<span class="nn">File ~/miniconda3/envs/ml_venv/lib/python3.9/site-packages/matplotlib/lines.py:1287,</span> in <span class="ni">Line2D.set_xdata</span><span class="nt">(self, x)</span>
<span class="g g-Whitespace">   </span><span class="mi">1281</span>     <span class="n">_api</span><span class="o">.</span><span class="n">warn_deprecated</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1282</span>         <span class="n">since</span><span class="o">=</span><span class="s2">&quot;3.7&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1283</span>         <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Setting data with a non sequence type &quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1284</span>         <span class="s2">&quot;is deprecated since </span><span class="si">%(since)s</span><span class="s2"> and will be &quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1285</span>         <span class="s2">&quot;remove </span><span class="si">%(removal)s</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1286</span>     <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="p">]</span>
<span class="ne">-&gt; </span><span class="mi">1287</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xorig</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1288</span> <span class="bp">self</span><span class="o">.</span><span class="n">_invalidx</span> <span class="o">=</span> <span class="kc">True</span>
<span class="g g-Whitespace">   </span><span class="mi">1289</span> <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

<span class="nn">File ~/miniconda3/envs/ml_venv/lib/python3.9/copy.py:74,</span> in <span class="ni">copy</span><span class="nt">(x)</span>
<span class="g g-Whitespace">     </span><span class="mi">67</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;Shallow copy operation on arbitrary Python objects.</span>
<span class="g g-Whitespace">     </span><span class="mi">68</span><span class="sd"> </span>
<span class="g g-Whitespace">     </span><span class="mi">69</span><span class="sd"> See the module&#39;s __doc__ string for more info.</span>
<span class="g g-Whitespace">     </span><span class="mi">70</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">     </span><span class="mi">72</span> <span class="bp">cls</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">74</span> <span class="n">copier</span> <span class="o">=</span> <span class="n">_copy_dispatch</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">75</span> <span class="k">if</span> <span class="n">copier</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">76</span>     <span class="k">return</span> <span class="n">copier</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<p>We can see that some variables seem independant like wind_direction and pressure_min. However, some other seem dependant like Pressure and Pressure_min. We also notice some extreme values.</p>
<p>Let’s calculate the VIF to have a metric to reduce the dimension. A VIF under 5 indicate a multicolinearity between some variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.stats.outliers_influence</span> <span class="kn">import</span> <span class="n">variance_inflation_factor</span>

<span class="k">def</span> <span class="nf">calculate_vif</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;feature&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span>
    <span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">))]</span>
    <span class="k">return</span> <span class="n">vif_data</span>

<span class="n">df_wind_reduced</span> <span class="o">=</span> <span class="n">df_wind</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">df_wind_reduced</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">vif_df</span> <span class="o">=</span> <span class="n">calculate_vif</span><span class="p">(</span><span class="n">df_wind_reduced</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">vif_df</span><span class="p">[</span><span class="s1">&#39;VIF&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="n">max_vif_index</span> <span class="o">=</span> <span class="n">vif_df</span><span class="p">[</span><span class="s1">&#39;VIF&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>
        <span class="n">max_vif</span> <span class="o">=</span> <span class="n">vif_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">max_vif_index</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">max_vif</span><span class="p">[</span><span class="s1">&#39;VIF&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">df_wind_reduced</span> <span class="o">=</span> <span class="n">df_wind_reduced</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">max_vif</span><span class="p">[</span><span class="s1">&#39;feature&#39;</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Dropped column </span><span class="si">{</span><span class="n">max_vif</span><span class="p">[</span><span class="s2">&quot;feature&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> with VIF </span><span class="si">{</span><span class="n">max_vif</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">break</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dropped column Pressure_min with VIF 969396.5131824163
Dropped column Pressure_max with VIF 222530.24434196184
Dropped column Temperature_max with VIF 2432.3576793441853
Dropped column Relative_humidity_avg with VIF 600.1156092687868
Dropped column Relative_humidity_max with VIF 324.8054449158098
Dropped column Pressure with VIF 132.81683694778437
Dropped column Wind_speed_max with VIF 29.881085360952348
Dropped column Temperature_min with VIF 15.91569214219379
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_wind_reduced</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Time</th>
      <th>Wind_direction</th>
      <th>Wind_speed</th>
      <th>Relative_humidity_min</th>
      <th>Precipitation_total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12</td>
      <td>0.809017</td>
      <td>1.8</td>
      <td>60.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13</td>
      <td>0.965926</td>
      <td>2.7</td>
      <td>55.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>14</td>
      <td>0.891007</td>
      <td>2.0</td>
      <td>50.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15</td>
      <td>0.848048</td>
      <td>2.5</td>
      <td>44.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>16</td>
      <td>0.224951</td>
      <td>2.4</td>
      <td>43.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>17</td>
      <td>0.034899</td>
      <td>1.8</td>
      <td>41.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>18</td>
      <td>0.819152</td>
      <td>1.8</td>
      <td>36.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>19</td>
      <td>0.798636</td>
      <td>1.1</td>
      <td>37.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>20</td>
      <td>0.945519</td>
      <td>1.5</td>
      <td>38.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>21</td>
      <td>-0.292372</td>
      <td>1.3</td>
      <td>45.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">correlation_matrix</span> <span class="o">=</span> <span class="n">df_wind_reduced</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">abs</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">correlation_matrix</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;.2f&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Variables&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Variables&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Correlation matrix&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/703127a810cc18a279ca3794dc4ac47940b3736f46e144746b29778e0e8e460d.png" src="_images/703127a810cc18a279ca3794dc4ac47940b3736f46e144746b29778e0e8e460d.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_wind_reduced</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;df_wind_reduced.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s do the same study for the fraud detection dataset</p>
</section>
</section>
<section id="fraud-detection">
<h2>Fraud detection<a class="headerlink" href="#fraud-detection" title="Link to this heading">#</a></h2>
<section id="id1">
<h3>Load data<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">train_identity</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;train_identity.csv&#39;</span><span class="p">)</span>
<span class="n">train_transaction</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;train_transaction.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_fraud</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">train_transaction</span><span class="p">,</span> <span class="n">train_identity</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;TransactionID&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing_data_count</span> <span class="o">=</span> <span class="n">df_fraud</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">missing_data_percentage</span> <span class="o">=</span> <span class="p">(</span><span class="n">missing_data_count</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_fraud</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>

<span class="n">missing_data_stats</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Missing data&#39;</span><span class="p">:</span> <span class="n">missing_data_count</span><span class="p">,</span>
    <span class="s1">&#39;Percentage of missing data&#39;</span><span class="p">:</span> <span class="n">missing_data_percentage</span>
<span class="p">})</span>

<span class="n">missing_data_stats</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Missing data</th>
      <th>Percentage of missing data</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>TransactionID</th>
      <td>0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>isFraud</th>
      <td>0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>TransactionDT</th>
      <td>0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>TransactionAmt</th>
      <td>0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>ProductCD</th>
      <td>0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>id_36</th>
      <td>449555</td>
      <td>76.126088</td>
    </tr>
    <tr>
      <th>id_37</th>
      <td>449555</td>
      <td>76.126088</td>
    </tr>
    <tr>
      <th>id_38</th>
      <td>449555</td>
      <td>76.126088</td>
    </tr>
    <tr>
      <th>DeviceType</th>
      <td>449730</td>
      <td>76.155722</td>
    </tr>
    <tr>
      <th>DeviceInfo</th>
      <td>471874</td>
      <td>79.905510</td>
    </tr>
  </tbody>
</table>
<p>434 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">df_fraud</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>434
</pre></div>
</div>
</div>
</div>
<p>If a columns contains more than 50% of Nan, we drop it since the column can be considered as non-relevant.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">threshold</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">columns_to_drop</span> <span class="o">=</span> <span class="n">missing_data_stats</span><span class="p">[</span><span class="n">missing_data_stats</span><span class="p">[</span><span class="s1">&#39;Percentage of missing data&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
<span class="n">df_fraud_filtered</span> <span class="o">=</span> <span class="n">df_fraud</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns_to_drop</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Columns dropped: </span><span class="si">{</span><span class="n">columns_to_drop</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Columns dropped: Index([&#39;dist1&#39;, &#39;dist2&#39;, &#39;R_emaildomain&#39;, &#39;D5&#39;, &#39;D6&#39;, &#39;D7&#39;, &#39;D8&#39;, &#39;D9&#39;, &#39;D12&#39;,
       &#39;D13&#39;,
       ...
       &#39;id_31&#39;, &#39;id_32&#39;, &#39;id_33&#39;, &#39;id_34&#39;, &#39;id_35&#39;, &#39;id_36&#39;, &#39;id_37&#39;, &#39;id_38&#39;,
       &#39;DeviceType&#39;, &#39;DeviceInfo&#39;],
      dtype=&#39;object&#39;, length=214)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_fraud_filtered</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(590540, 220)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">SimpleImputer</span>

<span class="n">numeric_columns</span> <span class="o">=</span> <span class="n">df_fraud_filtered</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;number&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span>
<span class="n">numeric_df</span> <span class="o">=</span> <span class="n">df_fraud_filtered</span><span class="p">[</span><span class="n">numeric_columns</span><span class="p">]</span>

<span class="n">object_columns</span> <span class="o">=</span> <span class="n">df_fraud_filtered</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span>
<span class="n">object_df</span> <span class="o">=</span> <span class="n">df_fraud_filtered</span><span class="p">[</span><span class="n">object_columns</span><span class="p">]</span>

<span class="n">imputer_numeric</span> <span class="o">=</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;median&#39;</span><span class="p">)</span>
<span class="n">imputed_numeric_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">imputer_numeric</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">numeric_df</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="n">numeric_columns</span><span class="p">)</span>

<span class="n">imputer_object</span> <span class="o">=</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;most_frequent&#39;</span><span class="p">)</span>
<span class="n">imputed_object_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">imputer_object</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">object_df</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="n">object_columns</span><span class="p">)</span>

<span class="n">df_fraud_filtered_imputed</span> <span class="o">=</span> <span class="n">df_fraud_filtered</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_fraud_filtered_imputed</span><span class="p">[</span><span class="n">numeric_columns</span><span class="p">]</span> <span class="o">=</span> <span class="n">imputed_numeric_df</span>
<span class="n">df_fraud_filtered_imputed</span><span class="p">[</span><span class="n">object_columns</span><span class="p">]</span> <span class="o">=</span> <span class="n">imputed_object_df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_fraud_filtered_imputed</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TransactionID</th>
      <th>isFraud</th>
      <th>TransactionDT</th>
      <th>TransactionAmt</th>
      <th>ProductCD</th>
      <th>card1</th>
      <th>card2</th>
      <th>card3</th>
      <th>card4</th>
      <th>card5</th>
      <th>...</th>
      <th>V312</th>
      <th>V313</th>
      <th>V314</th>
      <th>V315</th>
      <th>V316</th>
      <th>V317</th>
      <th>V318</th>
      <th>V319</th>
      <th>V320</th>
      <th>V321</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2987000.0</td>
      <td>0.0</td>
      <td>86400.0</td>
      <td>68.50</td>
      <td>W</td>
      <td>13926.0</td>
      <td>361.0</td>
      <td>150.0</td>
      <td>discover</td>
      <td>142.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>117.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2987001.0</td>
      <td>0.0</td>
      <td>86401.0</td>
      <td>29.00</td>
      <td>W</td>
      <td>2755.0</td>
      <td>404.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>102.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2987002.0</td>
      <td>0.0</td>
      <td>86469.0</td>
      <td>59.00</td>
      <td>W</td>
      <td>4663.0</td>
      <td>490.0</td>
      <td>150.0</td>
      <td>visa</td>
      <td>166.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2987003.0</td>
      <td>0.0</td>
      <td>86499.0</td>
      <td>50.00</td>
      <td>W</td>
      <td>18132.0</td>
      <td>567.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>117.0</td>
      <td>...</td>
      <td>135.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>50.0</td>
      <td>1404.0</td>
      <td>790.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2987004.0</td>
      <td>0.0</td>
      <td>86506.0</td>
      <td>50.00</td>
      <td>H</td>
      <td>4497.0</td>
      <td>514.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>102.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>590535</th>
      <td>3577535.0</td>
      <td>0.0</td>
      <td>15811047.0</td>
      <td>49.00</td>
      <td>W</td>
      <td>6550.0</td>
      <td>361.0</td>
      <td>150.0</td>
      <td>visa</td>
      <td>226.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>47.950001</td>
      <td>47.950001</td>
      <td>47.950001</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>590536</th>
      <td>3577536.0</td>
      <td>0.0</td>
      <td>15811049.0</td>
      <td>39.50</td>
      <td>W</td>
      <td>10444.0</td>
      <td>225.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>224.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>590537</th>
      <td>3577537.0</td>
      <td>0.0</td>
      <td>15811079.0</td>
      <td>30.95</td>
      <td>W</td>
      <td>12037.0</td>
      <td>595.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>224.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>590538</th>
      <td>3577538.0</td>
      <td>0.0</td>
      <td>15811088.0</td>
      <td>117.00</td>
      <td>W</td>
      <td>7826.0</td>
      <td>481.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>224.0</td>
      <td>...</td>
      <td>117.0</td>
      <td>317.500000</td>
      <td>669.500000</td>
      <td>317.500000</td>
      <td>0.0</td>
      <td>2234.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>590539</th>
      <td>3577539.0</td>
      <td>0.0</td>
      <td>15811131.0</td>
      <td>279.95</td>
      <td>W</td>
      <td>15066.0</td>
      <td>170.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>102.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>279.950012</td>
      <td>279.950012</td>
      <td>279.950012</td>
    </tr>
  </tbody>
</table>
<p>590540 rows × 220 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span>

<span class="n">object_columns</span> <span class="o">=</span> <span class="n">df_fraud_filtered_imputed</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
<span class="n">encoder</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span>
<span class="n">encoded_data</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_fraud_filtered_imputed</span><span class="p">[</span><span class="n">object_columns</span><span class="p">])</span>

<span class="n">categories</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">categories_</span>

<span class="n">encoded_columns</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">object_columns</span><span class="p">):</span>
    <span class="n">encoded_columns</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">category</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">category</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">:]])</span>

<span class="n">encoded_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">encoded_data</span><span class="o">.</span><span class="n">toarray</span><span class="p">(),</span> <span class="n">columns</span><span class="o">=</span><span class="n">encoded_columns</span><span class="p">)</span>

<span class="n">df_fraud_filtered_imputed_encoded</span> <span class="o">=</span> <span class="n">df_fraud_filtered_imputed</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">object_columns</span><span class="p">)</span>
<span class="n">df_fraud_filtered_imputed_encoded</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_fraud_filtered_imputed_encoded</span><span class="p">,</span> <span class="n">encoded_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">df_fraud_filtered_imputed_encoded</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;df_fraud_filtered_imputed_encoded.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_fraud_filtered_imputed_encoded</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;df_fraud_filtered_imputed_encoded.csv&#39;</span><span class="p">)</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">df_fraud_filtered_imputed_encoded</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">df_values</span> <span class="o">=</span> <span class="n">df_fraud_filtered_imputed_encoded</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;isFraud&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">vif</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">vif</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_values</span><span class="o">.</span><span class="n">columns</span>
    <span class="n">vif</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">df_values</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">df_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

    <span class="n">high_vif_variables</span> <span class="o">=</span> <span class="n">vif</span><span class="p">[</span><span class="n">vif</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">high_vif_variables</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="k">break</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Dropped column </span><span class="si">{</span><span class="n">high_vif_variables</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">high_vif_variables</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">(),</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> with VIF </span><span class="si">{</span><span class="n">high_vif_variables</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">df_fraud_filtered_imputed_encoded</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">high_vif_variables</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">vif</span><span class="p">[</span><span class="s1">&#39;VIF&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">(),</span><span class="s1">&#39;Variable&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dropped column V27 with VIF inf
Dropped column V28 with VIF inf
Dropped column V95 with VIF inf
Dropped column V106 with VIF inf
Dropped column V105 with VIF inf
Dropped column V132 with VIF inf
Dropped column V134 with VIF inf
Dropped column V133 with VIF inf
Dropped column V308 with VIF inf
Dropped column V31 with VIF inf
Dropped column V71 with VIF inf
Dropped column V85 with VIF inf
Dropped column V279 with VIF inf
Dropped column V280 with VIF inf
Dropped column V92 with VIF inf
Dropped column V15 with VIF inf
Dropped column V80 with VIF inf
Dropped column V21 with VIF inf
Dropped column V17 with VIF inf
Dropped column V306 with VIF inf
Dropped column V108 with VIF inf
Dropped column V112 with VIF inf
Dropped column card6_credit with VIF inf
Dropped column P_emaildomain_anonymous.com with VIF inf
Dropped column V307 with VIF 242878363.79540005
Dropped column V97 with VIF 17751376.75069719
Dropped column V96 with VIF 1322713.8502862197
Dropped column V128 with VIF 1234705.9928778608
Dropped column V318 with VIF 236081.45046358634
Dropped column V137 with VIF 80501.30001365484
Dropped column V103 with VIF 51495.015874341945
Dropped column V294 with VIF 39877.409322014006
Dropped column C10 with VIF 23449.97075193979
Dropped column V101 with VIF 15758.667384940545
Dropped column V320 with VIF 13981.568067712833
Dropped column V295 with VIF 8763.323274110277
Dropped column C1 with VIF 7962.920406910341
Dropped column V321 with VIF 7847.496234508189
Dropped column V317 with VIF 4741.905259310983
Dropped column C4 with VIF 3802.642566485261
Dropped column V102 with VIF 3746.7759212665014
Dropped column C11 with VIF 2831.312698060199
Dropped column V126 with VIF 2346.735590013564
Dropped column V298 with VIF 2304.2453490421176
Dropped column C12 with VIF 2036.1614492912952
Dropped column V40 with VIF 1716.7207988037849
Dropped column V59 with VIF 1475.807264856324
Dropped column V299 with VIF 1166.1613466613323
Dropped column C7 with VIF 956.3651832635134
Dropped column V293 with VIF 836.0800120406856
Dropped column C8 with VIF 678.2471140524746
Dropped column V63 with VIF 657.182659566911
Dropped column V33 with VIF 545.4929013699917
Dropped column V315 with VIF 511.37795324707633
Dropped column TransactionID with VIF 489.43561636623826
Dropped column C6 with VIF 428.52694310922664
Dropped column V292 with VIF 407.1225307759431
Dropped column V42 with VIF 378.20121028563995
Dropped column V136 with VIF 359.99284879562543
Dropped column V58 with VIF 335.40987011076345
Dropped column V127 with VIF 321.0613670326692
Dropped column V79 with VIF 285.9976894893937
Dropped column V22 with VIF 260.5396216390685
Dropped column V49 with VIF 220.5680573986095
Dropped column V51 with VIF 173.3423696008736
Dropped column V93 with VIF 154.6472684998397
Dropped column V131 with VIF 149.49267291525675
Dropped column V304 with VIF 117.72632371135539
Dropped column V69 with VIF 117.29365922408721
Dropped column V16 with VIF 107.54626284628522
Dropped column V78 with VIF 104.47474329150567
Dropped column ProductCD_W with VIF 84.49566037382716
Dropped column V55 with VIF 84.07298083266113
Dropped column V309 with VIF 82.3114720135048
Dropped column V29 with VIF 77.38722123745504
Dropped column V73 with VIF 71.36519078333234
Dropped column V303 with VIF 59.75691242366738
Dropped column V32 with VIF 56.27129632905092
Dropped column V43 with VIF 53.161639307603366
Dropped column V54 with VIF 51.213483564902255
Dropped column C13 with VIF 50.399830069232515
Dropped column V10 with VIF 49.75849784224613
Dropped column V129 with VIF 47.37032102355579
Dropped column V20 with VIF 45.743887122323294
Dropped column V90 with VIF 44.29463496189184
Dropped column V57 with VIF 44.24925359539419
Dropped column V64 with VIF 40.57795590276018
Dropped column V116 with VIF 39.73507269299832
Dropped column V94 with VIF 37.54988893523631
Dropped column V296 with VIF 36.62832338598772
Dropped column V35 with VIF 36.26925544040102
Dropped column V84 with VIF 34.63530110628358
Dropped column V12 with VIF 33.28695287276812
Dropped column C14 with VIF 30.792875500328325
Dropped column V99 with VIF 30.038267455577753
Dropped column card4_visa with VIF 28.595837573414563
Dropped column V312 with VIF 27.449509771594226
Dropped column V52 with VIF 26.621335236132115
Dropped column V45 with VIF 23.812026057430295
Dropped column V302 with VIF 22.782224910882096
Dropped column V72 with VIF 22.746253300521236
Dropped column V81 with VIF 21.65622500867459
Dropped column V288 with VIF 20.527332694959853
Dropped column V301 with VIF 19.854813872734496
Dropped column D1 with VIF 19.416322802446977
Dropped column V61 with VIF 19.241121000279716
Dropped column V297 with VIF 18.769562023933233
Dropped column V8 with VIF 18.319262539731323
Dropped column C9 with VIF 17.447974613596756
Dropped column V313 with VIF 17.257706191552632
Dropped column V100 with VIF 16.704625690540777
Dropped column V25 with VIF 16.618308644300463
Dropped column V18 with VIF 15.48425476747179
Dropped column V50 with VIF 15.17350196275748
Dropped column V86 with VIF 15.000285945905192
Dropped column V75 with VIF 14.44895382651112
Dropped column V74 with VIF 14.360076749125705
Dropped column V113 with VIF 13.11727804670579
Dropped column V125 with VIF 12.578501324351446
Dropped column V37 with VIF 12.092622343936034
Dropped column V82 with VIF 11.537481947340051
Dropped column V91 with VIF 10.965068990430368
Dropped column V56 with VIF 10.263052203296064
Dropped column V284 with VIF 10.088169445827374
Dropped column V282 with VIF 9.880272932382255
Dropped column V310 with VIF 8.88915741711118
Dropped column V67 with VIF 8.451564228130076
Dropped column V24 with VIF 8.135136650726361
Dropped column V6 with VIF 7.686560746191196
Dropped column V30 with VIF 7.033071348143441
Dropped column V5 with VIF 6.8512934554262
Dropped column V314 with VIF 6.6809770377305435
Dropped column V39 with VIF 6.399972556043917
Dropped column ProductCD_S with VIF 6.132903881167139
Dropped column V47 with VIF 6.106286587054454
Dropped column P_emaildomain_gmail.com with VIF 5.908169031257123
Dropped column V104 with VIF 5.7801401131465555
Dropped column V34 with VIF 5.341638723870718
Dropped column V285 with VIF 5.33519430124895
Dropped column V135 with VIF 5.0652005816931664
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_fraud_filtered_imputed_encoded</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(590540, 145)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_fraud_filtered_imputed_encoded</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;df_fraud_filtered_imputed_encoded_reduced.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="exercice1.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Exercice 1</p>
      </div>
    </a>
    <a class="right-next"
       href="exercice3.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Exercice 3</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wind-speed">Wind speed</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-data">Load data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#eda">EDA</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fraud-detection">Fraud detection</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Load data</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>